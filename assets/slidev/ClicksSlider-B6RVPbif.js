import{d as I,z as C,t as D,E as T,n as z,O as F,D as P,o as v,b as k,i as x,B as n,e as d,x as y,l as R,F as E,ag as V,ae as q,af as K,ai as j,h as A,p as O,a as U}from"../modules/vue-rOHTgtFx.js";import{C as N,q as X,r as G,_ as J}from"../index-C0ChEDTH.js";import{m as Q}from"../modules/unplugin-icons-D9kGfLix.js";const W=["innerHTML"],Y=["textContent"],Z=["textContent"],me=I({__name:"NoteDisplay",props:{class:null,noteHtml:null,note:null,highlight:{type:Boolean,default:!0},placeholder:null,clicksContext:null,autoScroll:{type:Boolean}},emits:["markerDblclick","markerClick"],setup(a,{emit:p}){const t=a,_=C(()=>{var u;return t.clicksContext!=null&&((u=t.noteHtml)==null?void 0:u.includes("slidev-note-click-mark"))}),m=D(null),c="slidev-note-fade",h="slidev-note-click-mark";function w(){var $,B;if(!m.value||!_.value)return;const u=Array.from(m.value.querySelectorAll(`.${h}`)),f=new Map,o=new Map;let b=0;for(const i of u){const l=Number(i.dataset.clicks);f.set(i,l);let s=i,e=i.parentElement;for(;e&&s!==m.value;)o.has(e)||o.set(e,[[null,b]]),o.get(e).push([s,l]),s=e,e=e.parentElement;b=l}const L=new Map;for(const[i,l]of o){let s=!1,e=0;for(const r of Array.from(i.childNodes)){let S=!1;for(;r===(($=l[e+1])==null?void 0:$[0]);)S=!0,e++;if(S)continue;let M=r;if(r.nodeType===3){if(!((B=r.textContent)!=null&&B.trim()))continue;M=document.createElement("span"),M.textContent=r.textContent,i.insertBefore(M,r),r.remove()}s||(s=e===0),L.set(M,l[e][1])}s||(l[0][1]=-1)}return i=>{const l=t.highlight;for(const[s,e]of o)s.classList.toggle(c,l&&!e.some(([r,S])=>S===i));for(const[s,e]of L)s.classList.toggle(c,l&&e!==i);for(const[s,e]of f)s.classList.remove(c),s.classList.toggle(`${h}-past`,l&&e<i),s.classList.toggle(`${h}-active`,l&&e===i),s.classList.toggle(`${h}-next`,l&&e===i+1),s.classList.toggle(`${h}-future`,l&&e>i+1),s.ondblclick=l?r=>{p("markerDblclick",r,e),!r.defaultPrevented&&(t.clicksContext.current=e,r.stopPropagation(),r.stopImmediatePropagation())}:null,s.onclick=l?r=>{p("markerClick",r,e)}:null,l&&t.autoScroll&&e===i&&s.scrollIntoView({block:"center",behavior:"smooth"})}}const g=D();return T(()=>[t.noteHtml,t.highlight],()=>{z(()=>{g.value=w()})},{immediate:!0}),F(()=>{w()}),P(()=>{var f,o;const u=((f=t.clicksContext)==null?void 0:f.current)??N;(o=g.value)==null||o.call(g,u)}),(u,f)=>a.noteHtml?(v(),k("div",{key:0,ref_key:"noteDisplay",ref:m,class:x(["prose overflow-auto outline-none slidev-note",[t.class,n(_)?"slidev-note-with-clicks":""]]),innerHTML:a.noteHtml},null,10,W)):a.note?(v(),k("div",{key:1,class:x(["prose overflow-auto outline-none slidev-note",t.class])},[d("p",{textContent:y(a.note)},null,8,Y)],2)):(v(),k("div",{key:2,class:x(["prose overflow-auto outline-none opacity-50 italic select-none slidev-note",t.class])},[d("p",{textContent:y(t.placeholder||"No notes.")},null,8,Z)],2))}}),H=a=>(O("data-v-207ce310"),a=a(),U(),a),ee=["title"],te={class:"flex gap-0.2 items-center min-w-16 font-mono mr1"},oe=H(()=>d("div",{"flex-auto":""},null,-1)),ne={"text-primary":""},se=H(()=>d("span",{op25:"","text-sm":""},"/",-1)),le={op50:"","text-sm":""},ae={key:1,op50:"","flex-auto":"",pl1:""},ce={relative:"","flex-auto":"",h5:"","font-mono":"",flex:"~"},ie=["min","max"],re=I({__name:"ClicksSlider",props:{clicksContext:null,readonly:{type:Boolean},active:{type:Boolean,default:!0}},setup(a){const p=a,t=C(()=>p.clicksContext.total),_=C(()=>X(0,p.clicksContext.clicksStart,t.value)),m=C(()=>t.value-_.value+1),c=C({get(){return p.clicksContext.current>t.value?-1:p.clicksContext.current},set(g){p.clicksContext.current=g}}),h=C(()=>G(_.value,t.value+1));function w(){p.readonly||(c.value<0||c.value>t.value)&&(c.value=0)}return(g,u)=>{const f=Q;return v(),k("div",{class:x(["flex gap-1 items-center select-none",n(m)&&p.clicksContext.isMounted?"":"op50"]),title:`Clicks in this slide: ${n(m)}`},[d("div",te,[R(f,{"text-sm":"",op50:""}),n(c)>=0&&n(c)!==n(N)&&a.active?(v(),k(E,{key:0},[oe,d("span",ne,y(n(c)),1),se,d("span",le,y(n(t)),1)],64)):(v(),k("div",ae,y(n(t)),1))]),d("div",ce,[(v(!0),k(E,null,V(n(h),o=>(v(),k("div",{key:o,border:"y main","of-hidden":"",relative:"",class:x([o===0?"rounded-l border-l":"",o===n(t)?"rounded-r border-r":""]),style:A({width:n(m)>0?`${1/n(m)*100}%`:"100%"})},[d("div",{absolute:"","inset-0":"",class:x(o<=n(c)&&a.active?"bg-primary op15":"")},null,2),d("div",{class:x([+o==+n(c)&&a.active?"text-primary font-bold op100 border-primary":"op30 border-main",o===0?"rounded-l":"",o===n(t)?"rounded-r":"border-r-2"]),"w-full":"","h-full":"","text-xs":"",flex:"","items-center":"","justify-center":"","z-1":""},y(o),3)],6))),128)),q(d("input",{"onUpdate:modelValue":u[0]||(u[0]=o=>j(c)?c.value=o:null),class:x(["range",a.readonly?"pointer-events-none":""]),type:"range",min:n(_),max:n(t),step:1,absolute:"","inset-0":"","z-10":"",op0:"",style:A({"--thumb-width":`${1/(n(m)+1)*100}%`}),onMousedown:w,onFocus:u[1]||(u[1]=o=>{var b;return(b=o.currentTarget)==null?void 0:b.blur()})},null,46,ie),[[K,n(c)]])])],10,ee)}}}),fe=J(re,[["__scopeId","data-v-207ce310"]]);export{fe as C,me as _};
